<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ApprovalMapper">
	<resultMap type="AppForm" id="appFormResultMap">
		<id property="formNo" column="FORM_NO"/>
		<result property="formName" column="FORM_NAME"/>
		<result property="formContent" column="FORM_CONTENT"/>
	</resultMap>
	<select id="selectForm" resultMap="appFormResultMap"><!-- 문서 양식 조회 -->
		SELECT * FROM APP_FORM WHERE FORM_NAME = #{parameter}
	</select>
	<insert id="insertDoc"><!-- 문서 등록 -->
		INSERT INTO APP_DOC VALUES
		<if test="formNo == 1">
			('D'||SEQ_DOC.NEXTVAL, #{memNum}, #{formNo}, #{docTitle}, #{docContent}, DEFAULT, #{docDate}, NULL, NULL, NULL, NULL, NULL)
		</if>
		<if test="formNo == 2">
			('A'||SEQ_DOC.NEXTVAL, #{memNum}, #{formNo}, #{docTitle}, #{docContent}, DEFAULT, #{docDate}, NULL, NULL, NULL, NULL, NULL)
		</if>
		<if test="formNo == 3">
			('L'||SEQ_DOC.NEXTVAL, #{memNum}, #{formNo}, #{docTitle}, #{docContent}, DEFAULT, #{docDate}, NULL, NULL, NULL, NULL, NULL)
		</if>
		<if test="formNo == 4">
			('E'||SEQ_DOC.NEXTVAL, #{memNum}, #{formNo}, #{docTitle}, #{docContent}, DEFAULT, #{docDate}, NULL, NULL, NULL, NULL, NULL)
		</if>
	</insert>
	<insert id="insertApp"><!-- 결재자 등록 -->
		INSERT INTO APPROVAL VALUES(SEQ_APP.NEXTVAL, 'D'||SEQ_DOC.CURRVAL, #{memNum}, #{appLevel}, NULL, DEFAULT, NULL)
	</insert>
	<insert id="insertRef"><!-- 참조자 등록 -->
		INSERT INTO APP_REF VALUES(SEQ_REF.NEXTVAL, 'D'||SEQ_DOC.CURRVAL, #{memNum})
	</insert>
	<insert id="insertFile"><!-- 파일 등록 -->
		INSERT INTO APP_FILE VALUES(SEQ_FILE.NEXTVAL, 'D'||SEQ_DOC.CURRVAL, #{fileName}, #{fileReName}, #{filePath})
	</insert>
</mapper>